# AI形象照风格识别功能

## 功能概述

当用户更新形象照时，系统会自动通过AI识别用户的穿搭风格，并智能推荐相应的风格标签，让用户能够快速完善个人风格档案。

## 功能特点

### 1. 智能风格识别
- **自动触发**: 形象照上传成功后自动开始AI识别
- **专业分析**: 使用火山引擎AI模型分析穿搭风格
- **多维度识别**: 识别颜色、风格、搭配等多个维度

### 2. 用户友好的交互
- **进度提示**: 实时显示AI分析进度
- **结果展示**: 清晰展示识别结果和置信度
- **用户选择**: 用户可选择是否应用AI识别的标签

### 3. 智能标签管理
- **标签验证**: 只识别预设的10个风格标签
- **去重处理**: 自动避免重复添加已有标签
- **数据库同步**: 自动保存到用户数据库

## 技术实现

### 1. AI识别工具类扩展

在 `miniprogram/utils/aiRecognition.js` 中新增：

```javascript
// 专门用于形象照风格识别的方法
async recognizeProfileStyle(imagePath, onProgress = null)

// 调用火山引擎API进行风格识别
async callProfileStyleAPI(base64Image, config)

// 验证和标准化识别结果
validateProfileStyleResult(result)
```

### 2. 页面功能集成

在 `miniprogram/pages/my/my.js` 中新增：

```javascript
// AI识别形象照风格
recognizeProfileStyle: function(filePath)

// 应用AI识别的标签
applyAiRecognizedTags: function()

// 忽略AI识别的标签
ignoreAiRecognizedTags: function()
```

### 3. 用户界面

#### 数据字段
```javascript
data: {
  // AI识别相关
  aiRecognitionResult: null, // AI识别结果
  showAiResultModal: false, // 是否显示AI识别结果弹窗
  aiRecognizedTags: [], // AI识别的标签
  isRecognizing: false // 是否正在识别中
}
```

#### 弹窗界面
- **识别结果展示**: 显示风格描述和置信度
- **标签预览**: 以特殊样式展示AI识别的标签
- **操作按钮**: 提供"应用标签"和"忽略"选项

## 工作流程

### 1. 形象照上传流程
```
用户选择形象照 → 上传到云存储 → 保存到数据库 → 触发AI识别
```

### 2. AI识别流程
```
图片压缩 → 获取API配置 → 调用AI模型 → 解析结果 → 显示弹窗
```

### 3. 用户确认流程
```
显示识别结果 → 用户选择 → 应用标签 → 保存到数据库 → 更新界面
```

## 支持的风格标签

系统支持以下10个预设风格标签：

1. **甜美** - 温柔可爱的风格
2. **冷色调** - 以蓝色、绿色为主的冷色系
3. **暖色调** - 以红色、黄色为主的暖色系
4. **简约** - 简洁大方的设计风格
5. **复古** - 怀旧经典的风格元素
6. **运动** - 运动休闲的穿搭风格
7. **优雅** - 成熟优雅的气质风格
8. **休闲** - 轻松舒适的日常风格
9. **正式** - 商务正式的着装风格
10. **可爱** - 活泼可爱的风格

## 用户体验优化

### 1. 进度反馈
- 实时显示AI分析进度百分比
- 分阶段提示：压缩图片 → 获取配置 → AI分析

### 2. 错误处理
- 网络错误友好提示
- 识别失败降级处理
- 超时自动重试机制

### 3. 视觉设计
- AI识别标签使用渐变色彩
- 弹窗动画效果
- 置信度可视化显示

## 配置要求

### 1. 火山引擎配置
- 需要在云函数中配置API Key和推理接入点
- 确保API调用权限和配额充足

### 2. 图片处理
- 自动压缩图片到45KB以下
- 支持最大600x600像素
- 质量压缩到60%

### 3. 性能优化
- 图片压缩减少传输时间
- 异步处理避免界面卡顿
- 结果缓存提升响应速度

## 使用说明

### 1. 触发条件
- 用户上传新的形象照
- 形象照成功保存到数据库后

### 2. 识别过程
- 系统自动开始AI分析
- 显示进度提示
- 通常需要10-20秒完成

### 3. 结果处理
- 显示识别结果弹窗
- 用户可选择应用或忽略
- 应用的标签会自动保存

## 注意事项

1. **网络依赖**: 需要稳定的网络连接
2. **API配额**: 注意火山引擎API调用次数限制
3. **图片质量**: 清晰的照片能获得更好的识别效果
4. **隐私保护**: 图片仅用于风格识别，不会存储

## 未来扩展

1. **更多标签**: 可扩展更多风格标签类型
2. **个性化**: 根据用户历史偏好优化推荐
3. **批量识别**: 支持多张照片批量分析
4. **风格建议**: 提供具体的搭配建议
